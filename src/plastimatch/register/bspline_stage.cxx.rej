--- Plastimatch/src/plastimatch/register/bspline_stage.cxx	2016-08-10 00:01:45.589993858 +0200
+++ GitLabPlastimatch/src/plastimatch/register/bspline_stage.cxx	2016-08-10 00:54:10.293292979 +0200
@@ -258,6 +258,7 @@
         bsp_parms->optimization = BOPT_LBFGSB;
     }
     bsp_parms->lbfgsb_pgtol = stage->pgtol;
+    bsp_parms->lbfgsb_mmax = stage->lbfgsb_mmax;
 
     /* Metric */
     bsp_parms->metric_type = stage->metric_type;
@@ -298,7 +299,13 @@
         print_and_exit ("Undefined impl type in gpuit_bspline\n");
     }
     logfile_printf ("Algorithm flavor = %c\n", bsp_parms->implementation);
+    logfile_printf ("Threading = %d\n", bsp_parms->threading);
 
+    if (stage->threading_type == THREADING_CUDA) {
+        bsp_parms->gpuid = stage->gpuid;
+        logfile_printf ("GPU ID = %d\n", bsp_parms->gpuid);
+    }
+    
     /* Regularization */
     bsp_parms->reg_parms->lambda = stage->regularization_lambda;
     switch (stage->regularization_type) {
